# 機能仕様書

## 1. 概要

本ドキュメントは、パーソナルトレーナー向け顧客管理アプリ「Trainer Desk」の機能仕様を定義します。

## 2. ユーザーロール

### 2.1 トレーナー（Trainer）
- パーソナルトレーニングを提供する側
- 複数のトレーニーを管理可能
- トレーニングメニューの作成・管理が可能

### 2.2 トレーニー（Trainee）
- パーソナルトレーニングを受ける側
- 1人または複数のトレーナーと契約可能
- 自身の予約・記録の閲覧が可能

## 3. 機能一覧

### 3.1 認証機能

#### 3.1.1 Googleログイン
- **対象**: 全ユーザー
- **説明**: Googleアカウントによるシングルサインオン
- **フロー**:
  1. ログイン画面で「Googleでログイン」ボタンをタップ
  2. Google認証画面へリダイレクト
  3. 認証完了後、アプリに戻る
  4. 初回ログイン時はロール選択画面へ遷移
  5. 2回目以降はホーム画面へ遷移

#### 3.1.2 ロール選択
- **対象**: 初回ログインユーザー
- **説明**: トレーナーまたはトレーニーの選択
- **注意**: 一度選択したロールは変更不可

#### 3.1.3 ログアウト
- **対象**: 全ユーザー
- **説明**: アプリからログアウト

### 3.2 プロフィール機能

#### 3.2.1 プロフィール閲覧
- **対象**: 全ユーザー
- **項目**:
  - 表示名
  - プロフィール画像
  - 自己紹介文
  - （トレーナーのみ）専門分野、資格、料金

#### 3.2.2 プロフィール編集
- **対象**: 全ユーザー
- **説明**: 自身のプロフィール情報を編集

### 3.3 トレーナー検索・契約機能

#### 3.3.1 トレーナー検索
- **対象**: トレーニー
- **説明**: 登録されているトレーナーを検索
- **検索条件**:
  - 名前
  - 専門分野
  - 地域

#### 3.3.2 契約リクエスト
- **対象**: トレーニー
- **説明**: トレーナーに対して契約リクエストを送信
- **フロー**:
  1. トレーナーのプロフィールを閲覧
  2. 「契約リクエスト」ボタンをタップ
  3. メッセージを入力して送信
  4. トレーナーの承認待ち

#### 3.3.3 契約承認・拒否
- **対象**: トレーナー
- **説明**: トレーニーからの契約リクエストを承認または拒否
- **フロー**:
  1. 契約リクエスト一覧を確認
  2. 個別のリクエストを選択
  3. 承認または拒否を選択

#### 3.3.4 契約解除
- **対象**: 全ユーザー
- **説明**: 既存の契約を解除
- **注意**: 未完了の予約がある場合は警告表示

### 3.4 予約管理機能

#### 3.4.1 予約可能時間設定（トレーナー）
- **対象**: トレーナー
- **説明**: 予約可能な時間帯を設定
- **設定項目**:
  - 曜日ごとの営業時間
  - 1セッションの時間（30分/60分/90分）
  - 休業日

#### 3.4.2 予約作成
- **対象**: トレーニー
- **説明**: トレーナーの空き時間に予約を作成
- **フロー**:
  1. 契約中のトレーナーを選択
  2. カレンダーから日付を選択
  3. 空き時間から希望時間を選択
  4. 予約内容を確認して送信

#### 3.4.3 予約確認・承認（トレーナー）
- **対象**: トレーナー
- **説明**: トレーニーからの予約リクエストを確認・承認
- **ステータス**:
  - 保留中（Pending）
  - 承認済み（Confirmed）
  - 拒否（Rejected）
  - キャンセル（Cancelled）
  - 完了（Completed）

#### 3.4.4 予約一覧表示
- **対象**: 全ユーザー
- **説明**: 自身の予約一覧を表示
- **表示形式**:
  - カレンダービュー
  - リストビュー

#### 3.4.5 予約キャンセル
- **対象**: 全ユーザー
- **説明**: 既存の予約をキャンセル
- **制限**: 予約時間の24時間前まで（設定可能）

#### 3.4.6 予約リマインダー
- **対象**: 全ユーザー
- **説明**: 予約前にプッシュ通知でリマインド
- **タイミング**: 24時間前、1時間前（設定可能）

### 3.5 トレーニング管理機能

#### 3.5.1 トレーニングメニュー作成
- **対象**: トレーナー
- **説明**: トレーニングメニューのテンプレートを作成
- **項目**:
  - メニュー名
  - 説明
  - エクササイズリスト
    - エクササイズ名
    - セット数
    - レップ数/時間
    - 休憩時間
    - 動画URL（任意）

#### 3.5.2 トレーニングメニュー割り当て
- **対象**: トレーナー
- **説明**: トレーニーにメニューを割り当て
- **設定項目**:
  - 対象トレーニー
  - 開始日
  - 頻度（週○回）
  - 期間

#### 3.5.3 トレーニング記録
- **対象**: 全ユーザー
- **説明**: 実施したトレーニングを記録
- **記録項目**:
  - 日時
  - メニュー
  - 各エクササイズの実績
    - 実施セット数
    - 実施レップ数/時間
    - 使用重量
  - メモ
  - 体調（5段階評価）

#### 3.5.4 トレーニング履歴閲覧
- **対象**: 全ユーザー
- **説明**: 過去のトレーニング記録を閲覧
- **表示形式**:
  - カレンダービュー
  - リストビュー
  - グラフビュー（進捗推移）

### 3.6 食事管理機能

#### 3.6.1 食事記録
- **対象**: トレーニー
- **説明**: 食事内容を記録
- **記録項目**:
  - 日時
  - 食事タイプ（朝食/昼食/夕食/間食）
  - 食事内容（テキスト）
  - 写真（任意）
  - カロリー（任意）
  - PFCバランス（任意）
    - タンパク質（Protein）
    - 脂質（Fat）
    - 炭水化物（Carbohydrate）

#### 3.6.2 食事記録閲覧（トレーナー）
- **対象**: トレーナー
- **説明**: 契約中トレーニーの食事記録を閲覧

#### 3.6.3 食事記録へのフィードバック
- **対象**: トレーナー
- **説明**: トレーニーの食事記録にコメントを追加

#### 3.6.4 食事履歴閲覧
- **対象**: 全ユーザー
- **説明**: 過去の食事記録を閲覧
- **表示形式**:
  - カレンダービュー
  - リストビュー
  - グラフビュー（カロリー/PFC推移）

### 3.7 チャット機能

#### 3.7.1 個別チャット
- **対象**: 全ユーザー
- **説明**: 契約中のトレーナー/トレーニーとの1対1チャット
- **機能**:
  - テキストメッセージ送信
  - 画像送信
  - 既読表示

#### 3.7.2 チャット一覧
- **対象**: 全ユーザー
- **説明**: チャットルーム一覧を表示
- **表示項目**:
  - 相手のアイコン・名前
  - 最新メッセージ
  - 未読件数
  - 最終更新日時

#### 3.7.3 プッシュ通知
- **対象**: 全ユーザー
- **説明**: 新着メッセージをプッシュ通知で通知

### 3.8 体重・体組成管理機能

#### 3.8.1 体重記録
- **対象**: トレーニー
- **説明**: 日々の体重を記録
- **記録項目**:
  - 日時
  - 体重
  - 体脂肪率（任意）
  - 筋肉量（任意）
  - メモ（任意）

#### 3.8.2 体重履歴閲覧
- **対象**: 全ユーザー
- **説明**: 体重の推移をグラフ表示
- **表示期間**: 1週間/1ヶ月/3ヶ月/6ヶ月/1年

#### 3.8.3 目標体重設定
- **対象**: トレーニー
- **説明**: 目標体重を設定

### 3.9 通知機能

#### 3.9.1 通知一覧
- **対象**: 全ユーザー
- **説明**: アプリ内通知の一覧表示

#### 3.9.2 通知種別
- 予約リクエスト（トレーナー向け）
- 予約承認/拒否（トレーニー向け）
- 予約リマインダー
- 新着メッセージ
- 契約リクエスト（トレーナー向け）
- 契約承認/拒否（トレーニー向け）
- 食事記録へのフィードバック（トレーニー向け）

### 3.10 設定機能

#### 3.10.1 通知設定
- **対象**: 全ユーザー
- **説明**: 通知のオン/オフ切り替え
- **設定項目**:
  - プッシュ通知全体
  - 予約リマインダー
  - チャット通知
  - その他通知

#### 3.10.2 アカウント設定
- **対象**: 全ユーザー
- **説明**: アカウント関連の設定
- **項目**:
  - ログアウト
  - アカウント削除

## 4. 画面一覧

### 4.1 共通画面
| 画面名 | 説明 |
|-------|------|
| スプラッシュ画面 | アプリ起動時の画面 |
| ログイン画面 | Googleログインボタン |
| ロール選択画面 | トレーナー/トレーニー選択 |
| ホーム画面 | ダッシュボード |
| プロフィール画面 | プロフィール閲覧・編集 |
| 通知一覧画面 | 通知一覧 |
| 設定画面 | 各種設定 |
| チャット一覧画面 | チャットルーム一覧 |
| チャット画面 | 個別チャット |

### 4.2 トレーナー専用画面
| 画面名 | 説明 |
|-------|------|
| トレーニー一覧画面 | 契約中トレーニー一覧 |
| トレーニー詳細画面 | トレーニーの詳細情報 |
| 契約リクエスト一覧画面 | 受信した契約リクエスト |
| 予約管理画面 | 予約一覧・カレンダー |
| 予約詳細画面 | 予約詳細・承認/拒否 |
| 営業時間設定画面 | 予約可能時間設定 |
| メニュー一覧画面 | トレーニングメニュー一覧 |
| メニュー作成画面 | トレーニングメニュー作成 |
| メニュー割り当て画面 | トレーニーへのメニュー割り当て |

### 4.3 トレーニー専用画面
| 画面名 | 説明 |
|-------|------|
| トレーナー検索画面 | トレーナー検索 |
| トレーナー詳細画面 | トレーナーのプロフィール |
| マイトレーナー画面 | 契約中トレーナー一覧 |
| 予約作成画面 | 新規予約作成 |
| 予約一覧画面 | 自身の予約一覧 |
| トレーニング記録画面 | トレーニング実績記録 |
| トレーニング履歴画面 | トレーニング履歴一覧 |
| 食事記録画面 | 食事内容記録 |
| 食事履歴画面 | 食事履歴一覧 |
| 体重記録画面 | 体重記録 |
| 体重履歴画面 | 体重推移グラフ |

## 5. 非機能要件

### 5.1 パフォーマンス
- 画面遷移: 2秒以内
- データ読み込み: 3秒以内
- 画像アップロード: 5秒以内（5MB以下）

### 5.2 セキュリティ
- 通信はすべてHTTPS
- Firebase Security Rulesによるアクセス制御
- 個人情報の暗号化

### 5.3 可用性
- サービス稼働率: 99.9%
- 定期メンテナンス: 月1回（深夜帯）

### 5.4 対応OS
- iOS: 14.0以上
- Android: 8.0 (API Level 26)以上
