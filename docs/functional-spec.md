# 機能仕様書 - TrainerDesk

## 1. 概要

TrainerDeskは、パーソナルトレーナーとトレーニー（クライアント）を繋ぐモバイルアプリケーションです。予約管理、トレーニング内容の記録、食事管理、チャット機能を提供します。

### 1.1 対象プラットフォーム
- iOS
- Android

### 1.2 ユーザー種別
| ユーザー種別 | 説明 |
|------------|------|
| トレーナー | パーソナルトレーニングを提供する側 |
| トレーニー | パーソナルトレーニングを受ける側 |

**※ 1人のユーザーが両方の役割を持つことが可能です**（例：トレーナーが別のトレーナーに習う場合）

---

## 2. 認証機能

### 2.1 Googleログイン
- Google OAuth 2.0を使用した認証
- 初回ログイン時にユーザー種別を選択（複数選択可）
  - トレーナーのみ
  - トレーニーのみ
  - 両方（トレーナー兼トレーニー）
- プロフィール情報（名前、メールアドレス、プロフィール画像）はGoogleアカウントから取得

### 2.2 セッション管理
- ログイン状態の永続化
- 自動ログイン機能
- ログアウト機能

### 2.3 役割切り替え
- 両方の役割を持つユーザーのみ、役割切り替えUIを表示
- **左右スワイプで役割を切り替え**（トレーナー ↔ トレーニー）
- 切り替え後は対応するダッシュボード・機能に遷移
- 単一役割のユーザーには切り替えUI非表示

**ユースケース例:**
- トレーナーが別のトレーナーに習う（トレーニーとして予約・受講）
- トレーナーが自分自身のトレーニングや食事を記録（セルフマネジメント）

---

## 3. トレーナー向け機能

### 3.1 プロフィール管理
- 自己紹介文の編集
- 専門分野・資格の登録
- 営業時間の設定
- 料金プランの設定
- プロフィール画像の変更

### 3.2 予約管理
- 予約一覧表示（日別/週別/月別ビュー）
- 予約の承認・拒否
- 予約のキャンセル
- 空き時間の設定
- 定休日の設定
- 予約リマインダー通知

### 3.3 クライアント（トレーニー）管理
- クライアント一覧表示
- クライアント招待（招待コード/リンク生成）
- クライアント情報の閲覧
- クライアントとの紐付け解除

### 3.4 トレーニング管理
- トレーニングメニューの作成・編集・削除
- セッションごとのトレーニング記録
  - 実施したエクササイズ
  - セット数・回数・重量
  - トレーニング時間
  - メモ・コメント
- トレーニング履歴の閲覧
- テンプレートメニューの作成

#### 3.4.1 マシン・エクササイズ選択
- **プリセットマシン一覧**（チョコザップ等の一般的なジムマシン）
  - チェストプレス、ラットプルダウン、レッグプレス等
  - カテゴリ別表示（胸・背中・脚・腕・肩・腹）
- フリーウェイト・自重トレーニングも選択可能
- カスタムエクササイズの追加

#### 3.4.2 テンプレート実行モード
- テンプレートメニューを選択して「開始」
- **ガイド付き実行画面**
  - 現在のエクササイズを大きく表示
  - 目標セット数・回数・重量を表示
  - 実績を入力して「次へ」で次のエクササイズへ
  - 進捗バー表示（3/8種目 など）
- セッション終了時に記録を自動保存

### 3.5 食事管理（クライアント側）
- クライアントの食事記録の閲覧
- 食事へのフィードバック・アドバイス
- 栄養バランスの確認

### 3.6 チャット機能
- クライアントとの1対1チャット
- 画像送信機能
- 既読機能
- プッシュ通知

### 3.7 指導履歴・予約状況
- **指導履歴一覧**
  - 日別/週別/月別の指導実績
  - いつ・誰を指導したかの一覧表示
  - トレーニング内容のサマリー
  - 絞り込み（クライアント別、期間指定）
- **予約状況ダッシュボード**
  - 今日・今週・今月の予約件数
  - ステータス別の予約一覧
    - 承認待ち（pending）
    - 確定済み（confirmed）
    - 完了（completed）
    - キャンセル（cancelled）
  - 直近の予約スケジュール
- **統計レポート**
  - 月間セッション数
  - クライアント別指導回数
  - 人気のトレーニングメニュー

---

## 4. トレーニー向け機能

### 4.1 プロフィール管理
- 基本情報の編集
  - 身長・体重（初期値として設定）
  - 目標（ダイエット、筋力アップなど）
  - 既往歴・注意事項
- プロフィール画像の変更

### 4.2 体重・身長記録
- **体重の時系列記録**
  - 日付ごとの体重を記録
  - 体脂肪率・筋肉量も記録可能（任意）
  - BMI自動計算
- **記録方法**
  - 手動入力
  - Health Connect（Android）からの自動取得
  - HealthKit（iOS）からの自動取得
- **グラフ表示**
  - 体重推移グラフ
  - 期間選択（1週間/1ヶ月/3ヶ月/1年）
  - 目標体重ラインの表示
- **トレーナーへの共有**
  - 紐付いているトレーナーは記録を閲覧可能

### 4.3 トレーナー連携
- トレーナーとの紐付け（招待コード/リンク入力）
- 紐付けトレーナーの確認
- トレーナーとの紐付け解除

### 4.4 予約管理
- トレーナーの空き時間確認
- 予約の申し込み
- 予約一覧表示
- 予約のキャンセル
- 予約リマインダー通知

### 4.5 トレーニング記録閲覧
- 過去のトレーニング記録の閲覧
- トレーニング履歴のグラフ表示
- 進捗の確認

### 4.6 食事管理
- 食事の記録
  - 食事写真のアップロード
  - 食事内容のテキスト入力
  - 食事時間の記録
  - 食事カテゴリ（朝食/昼食/夕食/間食）
- 食事履歴の閲覧
- カロリー・栄養素の概算表示（任意入力）
- トレーナーからのフィードバック確認

### 4.7 チャット機能
- トレーナーとの1対1チャット
- 画像送信機能
- 既読機能
- プッシュ通知

---

## 5. 共通機能

### 5.1 ダッシュボード
- 今日の予約表示
- 未読メッセージ数表示
- 最新の通知表示

### 5.2 通知機能
- プッシュ通知
  - 予約リマインダー
  - 予約ステータス変更
  - 新着メッセージ
  - 食事記録へのフィードバック
- アプリ内通知一覧

### 5.3 設定
- 役割の追加（トレーナー/トレーニーを後から追加可能）
- 通知設定のON/OFF
- アカウント削除
- 利用規約・プライバシーポリシーの確認
- お問い合わせ

### 5.4 Health Connect / HealthKit 連携
- **Android: Health Connect**
  - 体重データの読み取り権限リクエスト
  - バックグラウンドでの自動同期（設定でON/OFF可能）
  - 手動で「今すぐ同期」ボタン
- **iOS: HealthKit**
  - 体重データの読み取り権限リクエスト
  - バックグラウンドでの自動同期（設定でON/OFF可能）
  - 手動で「今すぐ同期」ボタン
- **同期設定**
  - 同期間隔の選択（毎日/手動のみ）
  - 同期対象の選択（体重、体脂肪率など）
  - 最終同期日時の表示

---

## 6. 画面一覧

### 6.1 共通画面
| 画面名 | 説明 |
|--------|------|
| スプラッシュ画面 | アプリ起動時の初期画面 |
| ログイン画面 | Googleログインボタン表示 |
| ユーザー種別選択画面 | トレーナー/トレーニー選択（複数可） |
| ダッシュボード | ホーム画面 |
| 通知一覧画面 | 通知履歴の表示 |
| 設定画面 | 各種設定 |
| ヘルス連携設定画面 | Health Connect/HealthKit連携設定 |
| チャット一覧画面 | チャットルーム一覧 |
| チャット画面 | 1対1のチャット |

### 6.2 トレーナー専用画面
| 画面名 | 説明 |
|--------|------|
| トレーナープロフィール編集画面 | 自己紹介・資格等の編集 |
| 予約管理画面 | カレンダー形式で予約表示 |
| 予約詳細画面 | 予約の詳細と操作 |
| スケジュール設定画面 | 空き時間・定休日設定 |
| クライアント一覧画面 | 担当クライアント一覧 |
| クライアント詳細画面 | クライアント情報詳細 |
| クライアント招待画面 | 招待コード/リンク生成 |
| トレーニングメニュー一覧画面 | メニューテンプレート管理 |
| トレーニングメニュー編集画面 | メニューの作成・編集 |
| エクササイズ選択画面 | マシン・エクササイズをカテゴリから選択 |
| セッション実行画面 | ガイド付きトレーニング実行 |
| セッション記録画面 | トレーニング実施記録 |
| クライアント食事一覧画面 | クライアントの食事記録閲覧 |
| クライアント体重履歴画面 | クライアントの体重推移グラフ |
| 指導履歴画面 | 日別/週別/月別の指導実績一覧 |
| 予約状況ダッシュボード画面 | ステータス別予約一覧・件数表示 |
| 統計レポート画面 | 月間実績・クライアント別統計 |

### 6.3 トレーニー専用画面
| 画面名 | 説明 |
|--------|------|
| トレーニープロフィール編集画面 | 基本情報の編集 |
| 体重記録画面 | 体重・体脂肪率の入力 |
| 体重履歴画面 | 体重推移グラフ表示 |
| トレーナー連携画面 | 招待コード入力 |
| 予約申込画面 | 空き時間選択・予約 |
| 予約一覧画面 | 自分の予約一覧 |
| トレーニング履歴画面 | 過去のトレーニング記録 |
| トレーニング詳細画面 | セッションの詳細 |
| 食事記録画面 | 食事の入力 |
| 食事履歴画面 | 過去の食事記録一覧 |
| 食事詳細画面 | 食事記録の詳細 |

---

## 7. 非機能要件

### 7.1 パフォーマンス
- アプリ起動時間: 3秒以内
- 画面遷移: 1秒以内
- API応答時間: 2秒以内

### 7.2 セキュリティ
- 通信の暗号化（HTTPS）
- 認証トークンの安全な管理
- 個人情報の適切な取り扱い

### 7.3 可用性
- オフライン時の基本操作対応（データはオンライン復帰時に同期）

### 7.4 対応言語
- 日本語

### 7.5 対応OS
- iOS 15.0以上
- Android 8.0（API Level 26）以上
